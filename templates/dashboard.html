<!-- templates/dashboard.html -->

<h1>ダッシュボード</h1>
<div class="tab-buttons">
    {% for person in people %}
    <div class="tab-button" id="button-{{ person.id }}" onclick="window.showTab({{ person.id }})">
        {{ person.name }}
    </div>
    {% endfor %}
</div>
{% for person in people %}
<div class="tab" id="tab-{{ person.id }}">
    <h2>{{ person.name }}のタスク</h2>
    {% if person.tasks %}
    {% for task in person.tasks %}
    {% set followup_class = task.follow_up_date|followup_style(today) %}
    <div class="task {{ followup_class }}">
        <!-- ステータスボタンの表示 -->
        <button id="status-button-{{ task.id }}" onclick="window.cycleStatus({{ task.id }})" class="status-button {{ task.status }}">
            {% if task.status == 'not_started' %}未着手
            {% elif task.status == 'pending' %}保留中
            {% elif task.status == 'in_progress' %}進行中
            {% elif task.status == 'completed' %}完了
            {% else %}不明{% endif %}
        </button>

        <!-- タイトルをリンクに変更 -->
        <a href="#" class="task-title-link" onclick="window.loadContent('/person_tasks/{{ task.person_id }}', 'task-{{ task.id }}')">
            {{ task.title }}
        </a>

        <!-- フォロー日 -->
        <span class="follow-up-date">フォロー日: {{ task.follow_up_date|format_date }}</span>
    </div>
    {% endfor %}
    {% else %}
    <p>タスクがありません。</p>
    {% endif %}
</div>
{% endfor %}

<!-- 必要なスタイルを追加 -->
<style>
        /* タブのスタイル */
        .tab {
            display: none;
        }
        .tab.active {
            display: block;
        }
        .tab-buttons {
            display: flex;
            margin-bottom: 10px;
        }
        .tab-button {
            padding: 10px;
            cursor: pointer;
            border: 1px solid #ccc;
            margin-right: 5px;
        }
        .tab-button.active {
            font-weight: bold;
            background-color: #eee;
        }
        /* タスクのスタイル */
        .task {
            padding: 10px;
            border-bottom: 1px solid #ccc;
            display: flex;
            align-items: center;
        }
        /* フォロー日の背景色と文字色 */
        .task.today {
            background-color: #FFCDD2; /* 薄い赤色 */
            color: black;
        }
        .task.three_days_ago {
            background-color: #FFEBEE; /* さらに薄い赤色 */
            color: black;
        }
        /* ステータスボタンのスタイル */
        .status-button {
            width: 100px; /* 幅を固定して左端を揃える */
            padding: 5px 10px;
            border-radius: 3px;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-right: 10px;
            flex-shrink: 0;
        }
        .status-button.pending {
            background-color: orange;
        }
        .status-button.in_progress {
            background-color: blue;
        }
        .status-button.completed {
            background-color: green;
        }
        .task-title-link {
            margin-right: 10px;
            flex-grow: 1;
            text-decoration: none;
            color: white; /* 白い文字 */
        }
        .task-title-link:hover {
            text-decoration: underline;
        }
        .follow-up-date {
            margin-right: 10px;
            flex-shrink: 0;
        }
</style>
